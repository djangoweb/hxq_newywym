{template 'header'}
<style>
body{ background-size:100% 100% ;background: #fff;}
a.more:link{  height: 16px;  padding: 1px 4px; font-size: 1.4rem;  border-radius:2px;background: #fed700; color: #6e2020; text-align: center;}
a.more:hover{  height: 16px;  padding: 1px 4px; font-size: 1.4rem;  border-radius:2px;background: #fed700; color: #6e2020; text-align: center;}
.more{height: 18px ; display: inline-block;  line-height:14px; font-size:1.4rem;color: #000； padding:2 4px; }
.btn{width: 80px; height: 80px; line-height: 80px; background: orange; color: #e60012;position: absolute;bottom: 15%;left: 0px;right: 0px;margin: auto;text-align: center;border-radius:50%;font-weight: bolder;font-size: 2.4rem;border:none;}
.btn.disable{ background: #cccccc; color:#fff;}
.award{ height:75%;width: 100%; position: relative;}
.corpright{height: 40px;line-height: 40px;bottom: 0px;position: absolute;text-align: center;color:#fff;width: 100%}

.btm{position: fixed;display:flex; height: 45px;bottom:0px;width: 100% }
.btm>div{flex:1; width: 25%; height: 45px; text-align: center; background:#f8f8f8 }
.btm>div:last-child{border-right:none: }
a.btmlink:link{ display:block; width: 100%;  height:100%;text-decoration:none; color: #000 }
a.btmlink:hover{ display:block; width: 100%;  height:100%;text-decoration:none; color: #000;}
a.btmlink:visited{ display:block; width: 100%;  height:100%;text-decoration:none; color: #000;}
.h35{height: 55px}
.text{ height: 15px;margin-top:5px ;display:inline-block; line-height: 15px;font-size: 14px;}
input.button{ padding: 0px 10px;min-width:100px;height:30px;line-height: 30px; background: #fed700; border-radius: 200px; color:#6e2020;box-shadow:0 4px 0 #f09e00, 0 5px 3px rgba(0, 0, 0, 0.3); text-align: center;display:inline-block;font-size: 1.4rem;border:none;}
input.large{ width: 100%;font-size: 1.4rem }
input.danger{ background: #f44040; color:#fff;box-shadow:0 4px 0 #ca0909, 0 5px 3px rgba(0, 0, 0, 0.3);}
input.success{ background: #5cb85c; color:#fff;box-shadow:0 4px 0 #2d962d, 0 5px 3px rgba(0, 0, 0, 0.3);}
a.button:link{ padding: 0px 10px;min-width:100px;height:30px;line-height: 30px; background: #fed700; border-radius: 200px; color:#6e2020;box-shadow:0 4px 0 #f09e00, 0 5px 3px rgba(0, 0, 0, 0.3); text-align: center;display:inline-block;font-size: 1.4rem}
a.button:hover{ padding: 0px 10px;min-width:100px;height:30px;line-height: 30px; background: #fed700; border-radius: 200px; color:#6e2020;box-shadow:0 4px 0 #f09e00, 0 5px 3px rgba(0, 0, 0, 0.3); text-align: center;display:inline-block;font-size: 1.4rem}
a.button:visited{ padding: 0px 10px;min-width:100px;height:30px;line-height: 30px; background: #fed700; border-radius: 200px; color:#6e2020;box-shadow:0 4px 0 #f09e00, 0 5px 3px rgba(0, 0, 0, 0.3); text-align: center;display:inline-block;font-size: 1.4rem}
a.large{ width: 100%;font-size: 1.4rem }
a.danger:link{ background: #f44040; color:#fff;box-shadow:0 4px 0 #ca0909, 0 5px 3px rgba(0, 0, 0, 0.3); }
a.danger:hover{ background: #f44040 ;color:#fff;box-shadow:0 4px 0 #ca0909, 0 5px 3px rgba(0, 0, 0, 0.3); }
a.danger:visited{ background: #f44040; color:#fff; box-shadow:0 4px 0 #ca0909, 0 5px 3px rgba(0, 0, 0, 0.3); }
a.success:link{ background: #5cb85c; color:#fff;box-shadow:0 4px 0 #2d962d, 0 5px 3px rgba(0, 0, 0, 0.3); }
a.success:hover{ background: #5cb85c ;color:#fff;box-shadow:0 4px 0 #2d962d, 0 5px 3px rgba(0, 0, 0, 0.3); }
a.success:visited{ background: #5cb85c;color:#fff; box-shadow:0 4px 0 #2d962d, 0 5px 3px rgba(0, 0, 0, 0.3); }
a.disable:link{ padding: 0px 10px;height:35px;line-height: 35px; background: #fcdea3; border-radius: 200px; color:#6e2020;box-shadow:0 4px 0 #facf7d, 0 5px 3px rgba(0, 0, 0, 0.3); text-align: center;display:inline-block}
a.disable:visited{ padding: 0px 10px;height:35px;line-height: 35px; background: #fcdea3; border-radius: 200px; color:#6e2020;box-shadow:0 4px 0 #facf7d, 0 5px 3px rgba(0, 0, 0, 0.3); text-align: center;display:inline-block}
.top{ height:25%; }
.top img{ width:100%;height: 100%}
</style>
<script>
var pagename='index';
var dscanwarning={$act['dscanwarning']};
var tk='{$_GPC['tk']}';
{if !empty($act['districtarr'])}
var districtarr={php echo json_encode($act['districtarr'])};
{/if}
var strDistrict='{$act['strDistrict']}';
var rptype={$act['rptype']};
var granttype={$act['granttype']};
var scanid={if $_M['scanid']}{$_M['scanid']}{else}0{/if};
var err={if $msg}{php echo json_encode($msg)}{else}{}{/if};
</script>
<style>
.banner{position: relative;width: 100%;height: 45%;}
.banner>.logo{ position: absolute;left: 40px;top:0px;width: 50px;height: 50px; }
.desc{margin:10px auto;width: 95%;font-size: 14px;word-break: break-all;white-space: pre-wrap;}
.title{position: absolute;bottom:50px;line-height: 40px;font-size: 20px;font-weight: bolder;text-align: center;width: 100%;color: #fff}
.subtitle{position: absolute;bottom:10px;line-height: 30px;font-size: 14px;text-align: center;width: 100%;color: #fff}
</style>
<div class="banner"><img src="{php echo $_W['attachurl'].$page['banner']}" width="100%" height="100%"><div class="logo"><img src="{php echo $_W['attachurl'].$page['logo']}" width="100%"></div><div class="title">{$page['title']}</div><div class="subtitle">{$page['subtitle']}</div></div>
<div style="margin:10px auto"><img src="{MODULE_URL}images/activity_v1_descbanner.png" width="100%"></div>
{loop $page['desc'] $key $item}
{if $item['type']=='image'}
<div class="desc"><img src="{$_W['attachurl']}{$item['value']}" width="100%"></div>
{else}
<div class="desc" style="text-indent:25px;">{$item['value']}</div>
{/if}
{/loop}
<div id="followlayer" class="layercontent">
<div class="body">
<div><img id="qrcode" src="{$_W['account']['qrcode']}" width="100%"/></div>
<div class="message" style="text-align: center;font-size: 1.4rem"></div>
</div>
</div>
<div id="sharelayer" class="layercontent">
<div class="body">
<div class="img"><img src="{MODULE_URL}/images/lzl.png" width="30%"></div>
<div class="message" style="text-align: center;font-size: 1.4rem"></div>
<div class="hmessage" style="text-align: center;font-size: 1.4rem"></div>
</div>
</div>
<div id="lotterylayer" class="layercontent">
<div class="body">
<div style="text-align: center;font-size: 1.4rem"><img src="{MODULE_URL}/images/lzl.png" width=30% /></div>
<div class="message" style="text-align: center;font-size: 1.4rem;color:#7e5537"></div>
</div>
<div class="footer"><a class="button" href="{php echo $this->createmobileurl('lottery',array('tk'=>$tk,'vtk'=>$vtk))}">领取红包</a></div>
</div>
<div id="errorlayer" class="layercontent">
<span class="close_ close" data-target=''>×</span>
<div class="body">
<div class="message" style="text-align: center;font-size: 1.4rem;color:#7e5537;line-height:24px;"></div>
</div>
</div>
<div id="myerrorlayer" class="layercontent">
<span class="close_ close" data-target=''>×</span>
<div class="body">
<div style="text-align: center;font-size: 1.4rem"><img src="{MODULE_URL}/images/lzl.png" width=30% /></div>
<div class="message" style="text-align: center;font-size: 1.4rem;color:#7e5537;line-height:24px;"></div>
</div>
<div class="footer"><a class="button" href="{php echo $this->createmobileurl('my',array('actid'=>$act['id']))}">个人中心</a></div>
</div>
<div id="sharelayer_">
<img src="{MODULE_URL}/images/share.png" width="100" height="100" class="close close_">
</div>
<div id="timeoutlayer" class="layercontent"></div>
<script>
require(['clipboard','index'],function(clipboard,modal){
	params={};
	modal.init(params);
	if (err.errno==0){
		if (granttype==0)
		{	
			$('#lotterylayer').find('.message').html(err.message)
			$('#lotterylayer').showlayer('','',false,false,'middle','')
		}else{
			$('#sharelayer_').showlayer()
			$('#sharelayer').find('.message').html(err.message)
			$('#sharelayer').find('.hmessage').html(err.hmessage)
			$('#sharelayer').showlayer('','',false,false,'middle','')
		}
	}else if(err.errno==6){
		$('#errorlayer').showlayer(err.message,'',false,false,'middle','')
	}else if(err.errno==7){
		$('#myerrorlayer').showlayer(err.message,'',false,false,'middle','')
	}else if(err.errno==4){
		$('#followlayer').find('#qrcode').attr('src',err.qrurl)
		$('#followlayer').find('.message').html(err.message)
		$('#followlayer').showlayer('','',false,false,'middle','')
	}else{
		$('#errorlayer').showlayer(err.message,'',false,false,'middle','')
	}
})
wx.ready(function(){
	wx.getLocation({
			success: function (res) {
				//alert(JSON.stringify(res))
				var latitude = res.latitude;//手机端坐标res.latitude， 开发者工具坐标res.res.latitude // 纬度，浮点数，范围为90 ~ -90
				var longitude = res.longitude;
				window.longitude=longitude
		   		window.latitude=latitude
				script=document.createElement('script')
				script.src='http://api.map.baidu.com/api?v=1.5&ak=8qkuwVCdEna6zLwLdHWmgPAv&callback=mapCallback'
				head=document.head||document.getElementsByTagName('head')[0]
				document.body.appendChild(script)
			    script.onload = script.onreadystatechange=function(){
			   	if(!this.readyState || this.readyState=='loaded' || this.readyState=='complete'){
				}
		　　　　	}
				script.onload = script.onreadystatechange = null;
			}
	})
})
function mapCallback(){
				var longitude,latitude,vdistrict;
				longitude=window.longitude,latitude=window.latitude;
				var point = new BMap.Point(longitude, latitude);    // 创建点坐标
									  var gc = new BMap.Geocoder(); //地址匹配类   
									  gc.getLocation(point, function(rs){
									  			city=rs.addressComponents.city;
									  			district=rs.addressComponents.district;
									  			province=rs.addressComponents.province;
									  			street=rs.addressComponents.street;
									  			streetNumber=rs.addressComponents.streetNumber;
												setCookie('city',city);	 
												setCookie('district',district);	 
												setCookie('province',province);
												setCookie('street',street);
												setCookie('streetnum',streetNumber);
												setCookie('address',rs.address);
												if (typeof districtarr!='undefined'&&(dscanwarning)){
													vdistrict=false
													for(a in districtarr){
													if (rs.address.indexOf(districtarr[a])!=-1){
														vdistrict=true
														break;
													}
													}
												}
												if (scanid){
													url='{php echo $this->createmobileurl('location',array('actid'=>$_M['act']['id'],'scanid'=>$_M['scanid']))}'
													if (typeof vdistrict!='undefined'){
														url=url+'&vdistrict='+vdistrict.toString()
													}
													//alert(url)
													$.ajax({
														type:'get',
														dataType:'json',
														url:url,
														success:function(data){
															console.log(data.message)
														},
														error:function(a,b,c){
															alert(b)
														},
													})
												}
								  	 })
}
</script>
{template 'footer'}